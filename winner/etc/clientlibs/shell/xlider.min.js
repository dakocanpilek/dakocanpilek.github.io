(function(b){window.requestAnimFrame=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(c){window.setTimeout(c,1000/60)
}
})();
var a={};
a.MIN_SPEED_FACTOR=0.05;
a.EASING_SPEED_FACTOR=0.005;
a.EASING_DISTANCE=0.2;
a.counter=0;
a.initData=function(d,e){var c={};
c.x=0;
c.id=a.counter++;
c.isTouchDown=false;
c.isScrolling=false;
c.mouseSlide=true;
c.startX=0;
c.startY=0;
c.wrapperWidth=0;
c.width=0;
c.height=0;
c.momentarySpeed=0;
c.i=0;
c.minSpeed=0;
c.speed=0;
c.remainingDistance=0;
c.slidesNumber=0;
c.currentSlide=0;
c.minX=0;
c.maxX=0;
c.easingDistance=0;
c.startFrame=0;
c.currentFrame=0;
c.auto=true;
c.delay=5*1000;
c.debug=false;
c.stopOnAction=true;
c.onNewSlide=null;
c.stopAnimation=false;
c.offset=0;
d.xdata=d.get(0).xdata=b.extend(c,e);
d.changeSlide=function(f){a.changeSlide(d,f)
}
};
a.init=function(d,e){a.initData(d,e);
var g=b('<div class="xlider-wrapper" style="width: 100%;-webkit-backface-visibility: hidden; -webkit-perspective: 1000; position: relative;"></div>');
d.wrap(g);
var c=d.children();
d.addClass("slider");
c.addClass("slide");
c.each(function(h,j){d.trigger("slideinit",[d,h])
});
var f=a.detectTransformations();
a.transformRule=f?f:null;
d.xdata.slidesNumber=c.length;
a.resize(d);
a.attachEvents(d);
a.animate(d);
d.trigger("slidechanged",[d]);
d.trigger("slideshown",[d]);
d.trigger("sliderinit",[d]);
a.log(d,"Slider initialized.")
};
a.detectTransformations=function(){var f=document.createElement("p"),g,c,e={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};
document.body.insertBefore(f,null);
for(var d in e){if(f.style[d]!==undefined){f.style[d]="translate3d(1px,1px,1px)";
c=e[d];
g=window.getComputedStyle(f).getPropertyValue(c)
}}document.body.removeChild(f);
if(g!==undefined&&g.length>0&&g!=="none"){return c
}return null
};
a.log=function(c,e){if(typeof console==="undefined"){return
}if(c.xdata.debug===true){var d="[slider "+c.xdata.id+"] "+e;
console.log(d);
b("#debug").text(d)
}};
a.resize=function(h){var i=h.parent();
var g=h.children();
if(h.xdata.wrapperWidth===i.outerWidth()){a.log(h,"No need to resize");
return
}a.log(h,"Resizing");
h.xdata.wrapperWidth=i.outerWidth();
h.attr("style","-webkit-backface-visibility: hidden; -webkit-perspective: 1000;");
g.attr("style","-webkit-backface-visibility: hidden; -webkit-perspective: 1000;");
var f=0;
var d=0;
var c=0;
g.each(function(j,k){if(b(this).outerHeight()>d){d=b(this).outerHeight()
}if(b(this).outerWidth()>f){f=b(this).outerWidth()
}c+=b(this).outerWidth()
});
h.outerWidth(c).outerHeight(d);
g.outerWidth(f).outerHeight(d);
i.css("overflow","hidden");
h.css("position","relative");
g.css("position","absolute");
var e=(h.xdata.width>0)?f/h.xdata.width:1;
a.log(h,"Ratio: "+e);
h.xdata.width=f;
h.xdata.height=f;
h.xdata.minSpeed=Math.ceil(f*a.MIN_SPEED_FACTOR);
h.xdata.easingSpeed=Math.ceil(f*a.EASING_SPEED_FACTOR);
h.xdata.easingDistance=Math.ceil(f*a.EASING_DISTANCE);
a.updateSlidesPosition(h);
h.xdata.x=Math.round(h.xdata.x*e);
h.xdata.remainingDistance=Math.round(h.xdata.remainingDistance*e);
a.forceShift(h);
h.off("load")
};
a.updateSlidesPosition=function(d){var c=d.children();
c.each(function(e,f){var g=e*d.xdata.width;
b(this).css("left",g+"px")
});
d.xdata.maxX=-c.first().position().left;
d.xdata.minX=-c.last().position().left
};
a.getDelay=function(e){var c=e.children().eq(e.xdata.currentSlide);
var d=c.data("delay")||e.xdata.delay;
return Math.round(60*d/1000)
};
a.animate=function(f){f.xdata.currentFrame+=1;
window.requestAnimFrame(function(){a.animate(f)
});
if(f.xdata.isTouchDown===true||f.xdata.stopAnimation===true){f.xdata.startFrame=f.xdata.currentFrame;
return
}var d=a.getDelay(f);
if(f.xdata.startFrame+d<f.xdata.currentFrame){if(f.xdata.auto===true){a.nextSlide(f);
f.xdata.startFrame=f.xdata.currentFrame;
return
}}if(f.xdata.remainingDistance===0){return
}f.xdata.startFrame=f.xdata.currentFrame;
var g=f.xdata.speed;
if(f.xdata.remainingDistance<f.xdata.easingDistance){var e=f.xdata.remainingDistance/f.xdata.easingDistance;
g=Math.round(g*e);
g=g>f.xdata.easingSpeed?g:f.xdata.easingSpeed
}var c=g<f.xdata.remainingDistance?g:f.xdata.remainingDistance;
f.xdata.remainingDistance-=c;
a.shift(f,f.xdata.direction*c);
if(f.xdata.remainingDistance===0){f.trigger("slideshown",[f])
}};
a.shift=function(d,e){d.xdata.x+=e;
if(d.xdata.x<d.xdata.minX){a.extendToRight(d)
}if(d.xdata.x>d.xdata.maxX){a.extendToLeft(d)
}if(d.xdata.remainingDistance<=(d.xdata.width/2)){var c=Math.round((-d.xdata.x-d.xdata.offset)/d.xdata.width)%d.xdata.slidesNumber;
if(c<0){c=d.xdata.slidesNumber+c
}if(c!==d.xdata.currentSlide){d.xdata.currentSlide=c;
a.log(d,"New slide: "+c);
d.trigger("slidechanged",[d])
}}a.forceShift(d)
};
a.forceShift=function(c){if(a.transformRule){c.css(a.transformRule,"translate3d("+c.xdata.x+"px, 0px, 0px)")
}else{c.css("left",c.xdata.x+"px")
}};
a.nextSlide=function(c){c.xdata.remainingDistance=c.xdata.width;
c.xdata.direction=-1;
c.xdata.speed=c.xdata.minSpeed
};
a.changeSlide=function(d,c){if(d.xdata.stopOnAction&&d.xdata.auto){d.xdata.auto=false
}if(c===d.xdata.currentSlide){return
}if(c<0||c>=d.xdata.slidesNumber){throw"Slide number out of range: "+c
}var f=(c<d.xdata.currentSlide)?1:-1;
var h=f*(d.xdata.currentSlide-c);
var e=h*d.xdata.width;
var g=Math.round(d.xdata.x)%d.xdata.width;
if(g!==0){g=(f===-1)?-g:d.xdata.width+g
}d.xdata.direction=f;
d.xdata.remainingDistance=e-g;
d.xdata.speed=Math.ceil((d.xdata.remainingDistance/d.xdata.width)*d.xdata.minSpeed);
if(d.xdata.speed<d.xdata.minSpeed){d.xdata.speed=d.xdata.minSpeed
}a.log(d,"Current slide: "+d.xdata.currentSlide);
a.log(d,"Changing slide to: "+c);
a.log(d,"Remaining distance: "+d.xdata.remainingDistance);
a.log(d,"Remaining speed: "+d.xdata.speed)
};
a.extendToRight=function(c){c.xdata.stopAnimation=true;
c.children().each(function(d,e){var f=b(this).position().left-c.xdata.width;
if(f<0){f=Math.abs(c.xdata.minX)
}b(this).css("left",f+"px")
});
c.xdata.offset-=c.xdata.width;
c.xdata.x+=c.xdata.width;
c.xdata.stopAnimation=false
};
a.extendToLeft=function(c){c.xdata.stopAnimation=true;
c.children().each(function(d,e){var f=b(this).position().left+c.xdata.width;
if(f>Math.abs(c.xdata.minX)){f=0
}b(this).css("left",f+"px")
});
c.xdata.offset+=c.xdata.width;
c.xdata.x-=c.xdata.width;
c.xdata.stopAnimation=false
};
a.getX=function(c){return c.pageX||c.originalEvent.touches[0].pageX
};
a.getY=function(c){return c.pageY||c.originalEvent.touches[0].pageY
};
a.touchStart=function(d,c){a.log(d,"Touch start");
d.xdata.momentarySpeed=0;
d.xdata.isScrolling=false;
d.xdata.isTouchDown=true;
d.xdata.startX=a.getX(c);
d.xdata.startY=a.getY(c)
};
a.touchEnd=function(d,c){a.log(d,"Touch end");
if(d.xdata.startX===0){return
}d.xdata.speed=d.xdata.i!==0?Math.round(d.xdata.momentarySpeed/d.xdata.i):d.xdata.minSpeed;
d.xdata.speed=d.xdata.speed>d.xdata.minSpeed?d.xdata.speed:d.xdata.minSpeed;
var e=Math.round(Math.abs(d.xdata.x)%d.xdata.width);
if(e===0){d.xdata.remainingDistance=0
}else{e=d.xdata.direction===-1?e:d.xdata.width-e;
d.xdata.remainingDistance=d.xdata.width-e
}d.xdata.isTouchDown=false;
if(d.xdata.stopOnAction&&d.xdata.auto){d.xdata.auto=false
}};
a.touchMove=function(f,e){if(f.xdata.isTouchDown===true&&f.xdata.isScrolling===false){var d=a.getX(e)-f.xdata.startX;
var c=a.getY(e)-f.xdata.startY;
if(f.xdata.startY!==0&&Math.abs(c)>Math.abs(d)){f.xdata.isScrolling=true;
return
}e.preventDefault();
f.xdata.startY=0;
f.xdata.direction=d<0?-1:1;
f.xdata.startX+=d;
f.xdata.momentarySpeed+=Math.abs(d);
f.xdata.i+=1;
a.shift(f,d)
}};
a.attachEvents=function(c){c.on("dragstart",function(d){d.preventDefault()
});
c.on("touchstart",function(d){a.touchStart(c,d)
});
c.on("touchend",function(d){a.touchEnd(c,d)
});
c.on("touchmove",function(d){a.touchMove(c,d)
});
if(c.xdata.mouseSlide===true){c.on("mousedown",function(d){a.touchStart(c,d)
});
c.on("mouseup",function(d){a.touchEnd(c,d)
});
c.on("mouseleave",function(d){a.touchEnd(c,d)
});
c.on("mousemove",function(d){a.touchMove(c,d)
})
}b(window).resize(function(){a.resize(c)
})
};
b.fn.xlider=function(d){if(b(this).length!==1){throw"Please select one instance of the slider."
}var c=b(this);
if(!c.xdata&&c.children().length>1){a.init(c,d)
}return c
}
})(jQuery);